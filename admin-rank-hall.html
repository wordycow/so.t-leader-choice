<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>so.t ì§ê¸‰ ê´€ë¦¬ì</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      color: #111827;
      min-height: 100vh;

      /* rank-hall.htmlê³¼ ë™ì¼í•œ ìš°ì£¼ ë°°ê²½ */
      background: #020617;
      background-image:
        url("img/bg-stars.jpg"),
        radial-gradient(circle at top, rgba(15,23,42,0.25) 0, rgba(15,23,42,0.9) 65%, #020617 100%);
      background-size: cover, cover;
      background-position: center top, center top;
      background-attachment: fixed, fixed;
      animation: bg-pan 60s linear infinite alternate;
    }

    @keyframes bg-pan {
      0% { background-position: center top, center top; }
      100% { background-position: center 20%, center top; }
    }

    .page-wrap {
      max-width: 1100px;
      margin: 24px auto 32px;
      padding: 0 12px 32px;
      width: 100%;
    }

    h1 {
      font-size: 22px;
      margin-bottom: 6px;
      color: #f9fafb;
    }

    .sub {
      font-size: 13px;
      color: #e5e7eb;
      margin-bottom: 16px;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 16px;
    }

    @media (min-width: 1040px) {
      .layout {
        grid-template-columns: minmax(0, 1.3fr) minmax(0, 0.7fr);
      }
    }

    .glass-panel {
      background: rgba(15,23,42,0.88);
      border-radius: 18px;
      padding: 14px 16px 16px;
      box-shadow: 0 14px 40px rgba(15,23,42,0.85);
      border: 1px solid rgba(148,163,184,0.4);
      color: #e5e7eb;
      backdrop-filter: blur(8px);
    }

    .glass-panel h2,
    .glass-panel h3 {
      margin: 0 0 8px;
      font-size: 16px;
      color: #f9fafb;
    }

    .glass-panel p {
      margin: 0;
    }

    .field-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 8px;
    }

    .field-row label {
      font-size: 13px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      flex: 1;
      min-width: 140px;
    }

    input,
    select,
    textarea {
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid rgba(148,163,184,0.9);
      font-size: 13px;
      font-family: inherit;
      background: rgba(15,23,42,0.8);
      color: #f9fafb;
    }

    textarea {
      resize: vertical;
      background: rgba(15,23,42,0.9);
    }

    .primary-btn,
    .secondary-btn {
      padding: 6px 12px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      white-space: nowrap;
    }

    .primary-btn {
      background: #1d4ed8;
      color: #f9fafb;
    }

    .secondary-btn {
      background: #e5e7eb;
      color: #111827;
    }

    .tools-row {
      margin: 6px 0 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .rank-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      margin-top: 6px;
    }

    .rank-table th,
    .rank-table td {
      padding: 6px 8px;
      border-bottom: 1px solid rgba(148,163,184,0.35);
    }

    .rank-table th {
      text-align: left;
      background: rgba(15,23,42,0.9);
      font-weight: 600;
    }

    .rank-table tr:last-child td {
      border-bottom: none;
    }

    #bulk-input {
      width: 100%;
      min-height: 120px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      margin-top: 6px;
    }

    .hint {
      font-size: 12px;
      color: #cbd5f5;
      margin-top: 2px;
    }

    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      background: rgba(15,23,42,0.9);
      padding: 1px 4px;
      border-radius: 4px;
      color: #e5e7eb;
    }

    ul {
      padding-left: 18px;
      margin: 4px 0 0;
      font-size: 13px;
      color: #e5e7eb;
    }

    ul li {
      margin-top: 2px;
    }

    /* ì¹´ë“œ í…ìŠ¤íŠ¸ ì…€ */
    .tagline-cell {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .tagline-text {
      flex: 1;
      min-height: 1em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 12px;
    }

    .small-btn {
      padding: 2px 8px;
      border-radius: 999px;
      border: none;
      background: #e5e7eb;
      color: #111827;
      font-size: 11px;
      cursor: pointer;
    }

    /* ì˜¤ë¥¸ìª½ í…ìŠ¤íŠ¸ í¸ì§‘ ì˜ì—­ */
    #rank-note-editor {
      width: 100%;
      min-height: 220px;
      margin-top: 6px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 13px;
    }

    .note-tools {
      margin-top: 6px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
  </style>
</head>
<body>
  <div class="page-wrap">
    <h1>so.t ì§ê¸‰ ê´€ë¦¬ì</h1>
    <p class="sub">
      ì´ í˜ì´ì§€ì—ì„œ ì§ê¸‰ì ëª©ë¡(<code>rank-hall.json</code>)ë§Œ ê´€ë¦¬í•´.  
      ì´ë¯¸ì§€ëŠ” íŒŒì¼ ì´ë¦„ ê·œì¹™ìœ¼ë¡œ <code>rank-hall.html</code>ì—ì„œ ìë™ ë§¤ì¹­í•  ê±°ë¼ ë³„ë„ ë“±ë¡ì´ í•„ìš” ì—†ì–´.
    </p>

    <div class="layout">
      <!-- ì™¼ìª½: ì§ê¸‰ì ê´€ë¦¬ -->
      <section class="glass-panel">
        <h2>ì§ê¸‰ì ê´€ë¦¬ (rank-hall.json)</h2>
        <p style="font-size:13px; color:#e5e7eb;">
          ê°œë³„ ì§ê¸‰ìëŠ” ìœ„ í¼ì—ì„œ â€œ<strong>+ ì§ê¸‰ì ì¶”ê°€</strong>â€ ë²„íŠ¼ìœ¼ë¡œ,  
          ë§ì€ ì¸ì›ì€ ì•„ë˜ â€œì¼ê´„ ì§ê¸‰ ì—…ë°ì´íŠ¸â€ì—ì„œ í•œ ë²ˆì— ë¶™ì—¬ë„£ì–´ì„œ ê´€ë¦¬.
        </p>

        <!-- ê°œë³„ ì¶”ê°€ í¼ -->
        <form id="rank-form">
          <div class="field-row">
            <label>
              ì§ê¸‰
              <select id="rank-select">
                <option value="">-- ì§ê¸‰ ì„ íƒ --</option>
                <option value="Member">Member</option>
                <option value="Star1">Star1</option>
                <option value="Star2">Star2</option>
                <option value="Star3">Star3</option>
                <option value="Pro1">Pro1</option>
                <option value="Pro2">Pro2</option>
                <option value="Pro3">Pro3</option>
                <option value="Pro4">Pro4</option>
                <option value="Pro5">Pro5</option>
                <option value="Pro6">Pro6</option>
                <option value="Pro7">Pro7</option>
                <option value="Pro8">Pro8</option>
                <option value="Pro9">Pro9</option>
                <option value="Pro10">Pro10</option>
                <option value="custom">+ ìƒˆ ì§ê¸‰ ì§ì ‘ ì…ë ¥</option>
              </select>
            </label>

            <label id="custom-rank-wrap" style="display:none;">
              ìƒˆ ì§ê¸‰ ì´ë¦„
              <input type="text" id="custom-rank" placeholder="ì˜ˆ: Royal Director" />
            </label>
          </div>

          <div class="field-row">
            <label>
              ì´ë¦„
              <input type="text" id="member-name" placeholder="ì´ë¦„" />
            </label>
            <label>
              ê°€ì…ì¼
              <input type="date" id="join-date" />
            </label>
          </div>

          <div class="field-row">
            <label style="flex:1;">
              ì¹´ë“œ í…ìŠ¤íŠ¸ (í•œ ì¤„)
              <input type="text" id="member-tagline" placeholder="ì˜ˆ: ìš°ì£¼ ìµœì´ˆ Pro10 ë‹¬ì„±ì" />
            </label>
          </div>

          <button type="submit" class="primary-btn">+ ì§ê¸‰ì ì¶”ê°€</button>
        </form>

        <div class="tools-row">
          <button id="copy-rank-json" class="secondary-btn">
            rank-hall.jsonìš© JSON ë³µì‚¬
          </button>
        </div>

        <table class="rank-table">
          <thead>
            <tr>
              <th>ì§ê¸‰</th>
              <th>ì´ë¦„</th>
              <th>ê°€ì…ì¼</th>
              <th>ê°€ì… í›„ ì¼ìˆ˜</th>
              <th>ì¹´ë“œ í…ìŠ¤íŠ¸</th>
            </tr>
          </thead>
          <tbody id="rank-table-body">
          </tbody>
        </table>

        <hr style="margin:12px 0; border:none; border-top:1px solid rgba(148,163,184,0.5);" />

        <!-- ì¼ê´„ ì—…ë°ì´íŠ¸ -->
        <h3>ì¼ê´„ ì§ê¸‰ ì—…ë°ì´íŠ¸</h3>
        <p style="font-size:13px; color:#e5e7eb;">
          ì•„ë˜ì²˜ëŸ¼ ìƒê¸´ ë¦¬ìŠ¤íŠ¸ë¥¼ ê·¸ëŒ€ë¡œ ë¶™ì—¬ ë„£ìœ¼ë©´, <strong>ìŠ¤íƒ€IÂ·ìŠ¤íƒ€IIÂ·ìŠ¤íƒ€IIIÂ·Pro1~Pro10</strong>ê¹Œì§€ ìë™ìœ¼ë¡œ ë°˜ì˜ë¼.<br />
          ì˜ˆ) <code>[L]KR-15323995 / ì´ìœ ì†¡ / 2025-11-21 / ìŠ¤íƒ€III</code><br />
          ì˜ˆ) <code>[R]KR-12345678 / ì•„ë¬´ê°œ / 2025-12-01 / Pro 6</code><br />
          ì˜ˆ) <code>[R]KR-10921084 / ë¦° / 2025-11-21 / í”„ë¡œX</code>
        </p>

        <textarea
          id="bulk-input"
          placeholder="[L]KR-15323995 / ì´ìœ ì†¡ / 2025-11-21 / ìŠ¤íƒ€III&#10;[R]KR-19863422 / ì´ì€ì§„ / 2025-11-21 / Pro 6"
        ></textarea>
        <div class="tools-row">
          <button id="bulk-apply" class="secondary-btn">
            ë¶™ì—¬ë„£ê¸° ë‚´ìš©ìœ¼ë¡œ ì§ê¸‰ì ì—…ë°ì´íŠ¸
          </button>
        </div>
      </section>

      <!-- ì˜¤ë¥¸ìª½: ì´ë¯¸ì§€ ìë™ ë§¤ì¹­ ê·œì¹™ ì•ˆë‚´ + í…ìŠ¤íŠ¸ í¸ì§‘ ì˜ì—­ -->
      <section class="glass-panel">
        <h2>ì´ë¯¸ì§€ ìë™ ë§¤ì¹­ ê·œì¹™ (ì½ê¸° ì „ìš©)</h2>
        <p class="hint">
          ì´ë¯¸ì§€ëŠ” GitHub <code>img</code> í´ë”ì— íŒŒì¼ëª…ë§Œ ë§ì¶° ì˜¬ë ¤ë‘ë©´ ë¼.  
          <strong>ë³„ë„ì˜ ë“±ë¡ ì—†ì´</strong> <code>rank-hall.html</code>ì—ì„œ ê·œì¹™ëŒ€ë¡œ ìë™ ì—°ê²°í•  ê±°ì•¼.
        </p>
        <h3 style="font-size:14px; margin-top:10px;">íŒŒì¼ ì´ë¦„ ê·œì¹™</h3>
        <ul>
          <li><code>Member</code> â†’ <code>img/member.png</code></li>
          <li><code>Star1</code> â†’ <code>img/star1.png</code></li>
          <li><code>Star2</code> â†’ <code>img/star2.png</code></li>
          <li><code>Star3</code> â†’ <code>img/star3.png</code></li>
          <li><code>Pro1</code> â†’ <code>img/pro1.png</code></li>
          <li>â€¦</li>
          <li><code>Pro10</code> â†’ <code>img/pro10.png</code></li>
        </ul>
        <p class="hint" style="margin-top:10px;">
          ê·¸ëŸ¬ë‹ˆê¹Œ, <strong>ì§ê¸‰ ì´ë¦„ë§Œ ì˜ ë§ì¶”ë©´</strong> ì´ë¯¸ì§€ëŠ” ìë™ìœ¼ë¡œ ë¶™ëŠ” êµ¬ì¡°ì•¼.<br />
          ì´ ê´€ë¦¬ì í˜ì´ì§€ì—ì„œëŠ” ì‚¬ëŒ/ì§ê¸‰/ê°€ì…ì¼/ì¹´ë“œ í…ìŠ¤íŠ¸ë§Œ ê´€ë¦¬í•˜ë©´ ëœë‹¤.
        </p>

        <hr style="margin:12px 0; border:none; border-top:1px solid rgba(148,163,184,0.5);" />

        <h3>ì§ê¸‰ ì•ˆë‚´ ë¬¸êµ¬ / ê³µì§€ í¸ì§‘</h3>
        <p class="hint">
          ì˜¤ë¥¸ìª½ <code>rank-hall.html</code> ìƒë‹¨ì— ë“¤ì–´ê°ˆ ì•ˆë‚´ ë¬¸êµ¬ë‚˜ ê³µì§€ë¥¼  
          ì—¬ê¸°ì„œ ë¶™ì—¬ë„£ê³  í¸ì§‘í•œ ë’¤, <strong>í…ìŠ¤íŠ¸ ë³µì‚¬</strong> ë²„íŠ¼ìœ¼ë¡œ ê°€ì ¸ë‹¤ ì“°ë©´ ë¼.
          (ë¸Œë¼ìš°ì €ì— ìë™ ì €ì¥ë˜ë‹ˆê¹Œ, ìƒˆë¡œ ì—´ì–´ë„ ë‚´ìš©ì´ ë‚¨ì•„ ìˆì–´.)
        </p>
        <textarea
          id="rank-note-editor"
          placeholder="ì—¬ê¸°ì— ì§ê¸‰ ì•ˆë‚´ ë¬¸êµ¬, ê³µì§€, ì¹´ë“œì— ë“¤ì–´ê°ˆ ê¸´ í…ìŠ¤íŠ¸ ë“±ì„ ììœ ë¡­ê²Œ ì‘ì„±í•˜ì„¸ìš”."
        ></textarea>
        <div class="note-tools">
          <button id="note-copy-btn" class="secondary-btn">í…ìŠ¤íŠ¸ ë³µì‚¬</button>
          <button id="note-clear-btn" class="secondary-btn">ë‚´ìš© ë¹„ìš°ê¸°</button>
        </div>
      </section>
    </div>
  </div>

  <script>
    const RANK_ORDER = [
  "Pro10","Pro9","Pro8","Pro7","Pro6","Pro5","Pro4","Pro3","Pro2","Pro1",
  "Star3","Star2","Star1","Member"   // ğŸ”¹ Member ìµœí•˜ìœ„
];
    function getRankIndex(rank) {
      const i = RANK_ORDER.indexOf(rank);
      return i === -1 ? 999 : i;
    }

    function calcDaysFromJoin(joinDateStr) {
      if (!joinDateStr) return "";
      const join = new Date(joinDateStr);
      if (isNaN(join.getTime())) return "";
      const today = new Date();
      const joinMs = new Date(join.getFullYear(), join.getMonth(), join.getDate()).getTime();
      const todayMs = new Date(today.getFullYear(), today.getMonth(), today.getDate()).getTime();
      const diffDays = Math.floor((todayMs - joinMs) / (1000 * 60 * 60 * 24));
      if (diffDays < 0) return "";
      return diffDays;
    }

    let rankData = [];

    const rankSelect = document.getElementById("rank-select");
    const customRankWrap = document.getElementById("custom-rank-wrap");
    const customRankInput = document.getElementById("custom-rank");

    rankSelect.addEventListener("change", () => {
      if (rankSelect.value === "custom") {
        customRankWrap.style.display = "flex";
      } else {
        customRankWrap.style.display = "none";
        customRankInput.value = "";
      }
    });

    function renderRankTable() {
      const tbody = document.getElementById("rank-table-body");
      tbody.innerHTML = "";

      const sorted = [...rankData].sort((a, b) => {
        const rankDiff = getRankIndex(a.rank) - getRankIndex(b.rank);
        if (rankDiff !== 0) return rankDiff;

        if (!a.joinDate && !b.joinDate) return 0;
        if (!a.joinDate) return 1;
        if (!b.joinDate) return -1;
        return a.joinDate.localeCompare(b.joinDate);
      });

      sorted.forEach((item) => {
        const days = calcDaysFromJoin(item.joinDate);
        const daysText = days === "" ? "" : `${days}ì¼`;

        const originalIndex = rankData.indexOf(item);

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${item.rank}</td>
          <td>${item.name}</td>
          <td>${item.joinDate || ""}</td>
          <td>${daysText}</td>
          <td>
            <div class="tagline-cell">
              <span class="tagline-text">${item.tagline || ""}</span>
              <button type="button"
                      class="small-btn edit-tagline-btn"
                      data-idx="${originalIndex}">
                í¸ì§‘
              </button>
            </div>
          </td>
        `;
        tbody.appendChild(tr);
      });

      attachTaglineEditors();
    }

    function attachTaglineEditors() {
      document.querySelectorAll(".edit-tagline-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          const idx = parseInt(btn.dataset.idx, 10);
          if (isNaN(idx) || idx < 0 || idx >= rankData.length) return;

          const current = rankData[idx];
          const currentText = current.tagline || "";

          const next = window.prompt(
            `"${current.name}" ì¹´ë“œ í…ìŠ¤íŠ¸(í•œ ì¤„)ë¥¼ ì…ë ¥í•˜ì„¸ìš”.\në¹„ìš°ë©´ ì¹´ë“œ í…ìŠ¤íŠ¸ê°€ ì‚­ì œë©ë‹ˆë‹¤.`,
            currentText
          );

          if (next === null) return;   // ì·¨ì†Œ

          current.tagline = next.trim();
          renderRankTable();
        });
      });
    }

    document.getElementById("rank-form").addEventListener("submit", (e) => {
      e.preventDefault();

      let rank = rankSelect.value;
      if (rank === "custom") {
        rank = customRankInput.value.trim();
      }

      const name = document.getElementById("member-name").value.trim();
      const joinDate = document.getElementById("join-date").value;
      const tagline = document.getElementById("member-tagline").value.trim();

      if (!rank || !name) {
        alert("ì§ê¸‰ê³¼ ì´ë¦„ì€ í•„ìˆ˜ì•¼.");
        return;
      }

      rankData.push({
        name,
        rank,
        joinDate: joinDate || "",
        tagline: tagline || ""
      });

      document.getElementById("member-name").value = "";
      document.getElementById("join-date").value = "";
      document.getElementById("member-tagline").value = "";
      rankSelect.value = "";
      customRankWrap.style.display = "none";
      customRankInput.value = "";

      renderRankTable();
    });

    document.getElementById("copy-rank-json").addEventListener("click", () => {
      const json = JSON.stringify(rankData, null, 2);
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(json)
          .then(() => alert("rank-hall.jsonìš© JSONì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ëì–´.\nGitHubì˜ rank-hall.jsonì— ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ìœ¼ë©´ ë¼."))
          .catch(() => {
            alert("í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨. ì½˜ì†”ì— JSONì„ ì°ì–´ë‘˜ê²Œ.");
            console.log(json);
          });
      } else {
        alert("í´ë¦½ë³´ë“œ APIë¥¼ ì“¸ ìˆ˜ ì—†ì–´ì„œ ì½˜ì†”ì— JSONì„ ì°ì—ˆì–´.");
        console.log(json);
      }
    });

    // ===== ì¼ê´„ ì§ê¸‰ ì—…ë°ì´íŠ¸ (Star + Pro ìˆ«ì + Pro ë¡œë§ˆ ìˆ«ì) =====
       // ===== ì¼ê´„ ì§ê¸‰ ì—…ë°ì´íŠ¸ (Star + Pro ìˆ«ì + Pro ë¡œë§ˆ ìˆ«ì) =====
    function normalizeRankLabel(raw) {
      if (!raw) return "";
      let t = raw.replace(/\s+/g, "").toUpperCase();  // ê³µë°± ì œê±° + ëŒ€ë¬¸ì

      // MEMBER (í•œê¸€ / ì˜ë¬¸)
      if (t.includes("MEMBER") || t.includes("ë©¤ë²„")) return "Member";

      // STAR (í•œê¸€ / ì˜ë¬¸)
      if (t.includes("ìŠ¤íƒ€III") || t.includes("ìŠ¤íƒ€3") || t.includes("STAR3")) return "Star3";
      if (t.includes("ìŠ¤íƒ€II")  || t.includes("ìŠ¤íƒ€2") || t.includes("STAR2")) return "Star2";
      if (t.includes("ìŠ¤íƒ€I")   || t.includes("ìŠ¤íƒ€1") || t.includes("STAR1")) return "Star1";

      // PRO ìˆ«ì (PRO6, í”„ë¡œ10 ë“±)
      let m = t.match(/PRO(\d{1,2})/);
      if (m) {
        let num = parseInt(m[1], 10);
        if (!isNaN(num) && num >= 1) {
          if (num > 10) num = 10;
          return `Pro${num}`;
        }
      }

      m = t.match(/í”„ë¡œ(\d{1,2})/);
      if (m) {
        let num = parseInt(m[1], 10);
        if (!isNaN(num) && num >= 1) {
          if (num > 10) num = 10;
          return `Pro${num}`;
        }
      }

      // PRO ë¡œë§ˆ ìˆ«ì (PROI ~ PROX, í”„ë¡œI ~ í”„ë¡œX)
      const romanMap = {
        "I": 1,
        "II": 2,
        "III": 3,
        "IV": 4,
        "V": 5,
        "VI": 6,
        "VII": 7,
        "VIII": 8,
        "IX": 9,
        "X": 10
      };

      m = t.match(/PRO([IVX]+)/);
      if (m) {
        const rn = m[1];
        const num = romanMap[rn];
        if (num) return `Pro${num}`;
      }

      m = t.match(/í”„ë¡œ([IVX]+)/);
      if (m) {
        const rn = m[1];
        const num = romanMap[rn];
        if (num) return `Pro${num}`;
      }

      return "";
    }


    function upsertRankByName(name, rank, joinDate) {
      const existing = rankData.find((item) => item.name === name);

      if (existing) {
        existing.rank = rank;
        if (joinDate) existing.joinDate = joinDate;
      } else {
        rankData.push({
          name,
          rank,
          joinDate: joinDate || "",
          tagline: ""
        });
      }
    }

    document.getElementById("bulk-apply").addEventListener("click", () => {
      const text = document.getElementById("bulk-input").value;
      if (!text.trim()) {
        alert("ë¶™ì—¬ ë„£ì„ ë‚´ìš©ì„ ë¨¼ì € ì…ë ¥í•´ ì¤˜.");
        return;
      }

      const lines = text.split(/\r?\n/);
      let updatedCount = 0;

      for (const rawLine of lines) {
        const line = rawLine.trim();
        if (!line) continue;

        // [L]KR-15323995 / ì´ë¦„ / 2025-11-21 / ìŠ¤íƒ€III ë˜ëŠ” Pro 6 ë˜ëŠ” í”„ë¡œX
        const parts = line.split(" / ");
        if (parts.length < 4) continue;

        const name = (parts[1] || "").trim();
        const joinDate = (parts[2] || "").trim();
               const rawRank = (parts[3] || "").trim();
        let rank;

        if (!rawRank) {
          // ğŸ”¹ ì§ê¸‰ ì¹¸ì´ ì™„ì „íˆ ë¹„ì–´ ìˆìœ¼ë©´ â†’ ë¬´ì§ê¸‰ = Member
          rank = "Member";
        } else {
          // ğŸ”¹ ë­”ê°€ ì¨ ìˆìœ¼ë©´ normalizeRankLabelë¡œ Star/Pro/Member íŒë³„
          rank = normalizeRankLabel(rawRank);
          if (!rank) {
            // ì•Œì•„ë¨¹ì„ ìˆ˜ ì—†ëŠ” ì§ê¸‰ í…ìŠ¤íŠ¸ë©´ ê·¸ëƒ¥ ê±´ë„ˆë›´ë‹¤
            continue;
          }
        }

        if (!name) continue;

        upsertRankByName(name, rank, joinDate);
        updatedCount++;
      }

      renderRankTable();

      alert(
        `ì¼ê´„ ì—…ë°ì´íŠ¸ ì™„ë£Œ.\n` +
        `ë°˜ì˜ëœ ì¸ì›: ${updatedCount}ëª…\n\n` +
        `ë§ˆìŒì— ë“¤ë©´ JSON ë³µì‚¬ ë²„íŠ¼ ëˆŒëŸ¬ì„œ rank-hall.jsonì— ë¶™ì—¬ ë„£ìœ¼ë©´ ë¼.`
      );
    });

    // ===== ì˜¤ë¥¸ìª½ í…ìŠ¤íŠ¸ í¸ì§‘ê¸° (localStorage ì €ì¥ + ë³µì‚¬) =====
    const NOTE_STORAGE_KEY = "rankHallNoteEditor";
    const noteEditor = document.getElementById("rank-note-editor");
    const noteCopyBtn = document.getElementById("note-copy-btn");
    const noteClearBtn = document.getElementById("note-clear-btn");

    // ì´ˆê¸° ë¡œë“œ ì‹œ localStorageì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
    try {
      const saved = localStorage.getItem(NOTE_STORAGE_KEY);
      if (saved != null) {
        noteEditor.value = saved;
      }
    } catch (e) {
      console.warn("rankHall note load failed:", e);
    }

    // ì…ë ¥í•  ë•Œë§ˆë‹¤ ì €ì¥
    noteEditor.addEventListener("input", () => {
      try {
        localStorage.setItem(NOTE_STORAGE_KEY, noteEditor.value);
      } catch (e) {
        console.warn("rankHall note save failed:", e);
      }
    });

    // í…ìŠ¤íŠ¸ ë³µì‚¬
    noteCopyBtn.addEventListener("click", () => {
      const text = noteEditor.value || "";
      if (!text.trim()) {
        alert("ë³µì‚¬í•  í…ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.");
        return;
      }
      noteEditor.select();
      noteEditor.setSelectionRange(0, noteEditor.value.length);
      try {
        const ok = document.execCommand("copy");
        if (ok) {
          alert("í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. rank-hall.html ë“± ì›í•˜ëŠ” ê³³ì— ë¶™ì—¬ ë„£ìœ¼ì„¸ìš”.");
        } else {
          alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í…ìŠ¤íŠ¸ë¥¼ ì§ì ‘ ë“œë˜ê·¸í•´ì„œ ë³µì‚¬í•´ ì£¼ì„¸ìš”.");
        }
      } catch (e) {
        alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í…ìŠ¤íŠ¸ë¥¼ ì§ì ‘ ë“œë˜ê·¸í•´ì„œ ë³µì‚¬í•´ ì£¼ì„¸ìš”.");
      }
    });

    // ë‚´ìš© ë¹„ìš°ê¸°
    noteClearBtn.addEventListener("click", () => {
      if (!noteEditor.value.trim()) return;
      if (!confirm("í¸ì§‘ ë‚´ìš©ì„ ëª¨ë‘ ë¹„ìš¸ê¹Œìš”? (localStorageì— ì €ì¥ëœ ë‚´ìš©ë„ ì§€ì›Œì§‘ë‹ˆë‹¤.)")) return;
      noteEditor.value = "";
      try {
        localStorage.removeItem(NOTE_STORAGE_KEY);
      } catch (e) {}
    });

    // ì´ˆê¸° ë Œë”
    renderRankTable();
  </script>
</body>
</html>
