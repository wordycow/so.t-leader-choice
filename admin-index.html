<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì—¬í–‰ ë¦¬ë” ê´€ë¦¬ì í˜ì´ì§€ (ê´‘ê³  + JSON ìƒì„±ê¸°)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
      background: #f3f4f6;
      color: #111827;
    }
    .page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px 12px 40px;
    }
    header {
      text-align: center;
      margin-bottom: 18px;
    }
    header h1 {
      margin: 0 0 4px;
      font-size: 22px;
      font-weight: 700;
      color: #111827;
    }
    header p {
      margin: 0;
      font-size: 13px;
      color: #6b7280;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
      gap: 16px;
    }
    @media (max-width: 960px) {
      .layout {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: #ffffff;
      border-radius: 16px;
      padding: 16px 18px;
      margin-bottom: 12px;
      box-shadow: 0 4px 16px rgba(15,23,42,0.08);
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }
    .card-title {
      font-size: 15px;
      font-weight: 600;
      color: #111827;
    }
    .card-subtitle {
      font-size: 12px;
      color: #6b7280;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
    }
    .form-row {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .label-sm {
      font-size: 12px;
      color: #4b5563;
    }
    .input,
    .textarea {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      font-size: 13px;
      background: #f9fafb;
    }
    .textarea {
      resize: vertical;
      min-height: 70px;
    }
    .input:focus,
    .textarea:focus {
      outline: none;
      border-color: #111827;
      background: #ffffff;
      box-shadow: 0 0 0 1px #11182722;
    }
    .checkbox-row {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 4px;
    }
    .checkbox-row label {
      font-size: 12px;
      color: #4b5563;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 6px 10px;
      font-size: 12px;
      font-weight: 500;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      background: #ffffff;
      color: #374151;
      cursor: pointer;
      gap: 4px;
      transition: all 0.16s ease;
      white-space: nowrap;
    }
    .btn:hover {
      background: #f3f4f6;
    }
    .btn-primary {
      border-color: #111827;
      background: #111827;
      color: #f9fafb;
    }
    .btn-primary:hover {
      background: #020617;
    }
    .btn-danger {
      border-color: #b91c1c;
      color: #b91c1c;
    }
    .btn-danger:hover {
      background: #fef2f2;
    }
    .btn-outline {
      border-style: dashed;
      border-color: #d1d5db;
      background: #f9fafb;
    }
    .btn[disabled] {
      opacity: 0.5;
      cursor: default;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      border: 1px solid transparent;
    }
    .badge-on {
      background: #ecfdf5;
      border-color: #bbf7d0;
      color: #15803d;
    }
    .badge-off {
      background: #fef2f2;
      border-color: #fecaca;
      color: #b91c1c;
    }

    .list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .list-item {
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 8px 10px;
      background: #f9fafb;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .list-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }
    .list-top-left {
      display: flex;
      align-items: center;
      gap: 8px;
      min-width: 0;
    }
    .list-title {
      font-size: 13px;
      font-weight: 600;
      color: #111827;
    }
    .list-sub {
      font-size: 11px;
      color: #6b7280;
    }
    .list-actions {
      margin-top: 4px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }
    .list-thumb {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      object-fit: cover;
      border: 1px solid #e5e7eb;
      flex-shrink: 0;
      background: #e5e7eb;
    }

    .json-textarea {
      width: 100%;
      min-height: 150px;
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      padding: 10px;
      border-radius: 12px;
      border: 1px solid #d1d5db;
      background: #f9fafb;
      resize: vertical;
    }
    .json-textarea:focus {
      outline: none;
      border-color: #111827;
      background: #ffffff;
      box-shadow: 0 0 0 1px #11182722;
    }

    .help-text {
      font-size: 11px;
      color: #6b7280;
      margin-top: 4px;
    }

    .help-box-yellow {
      margin-top: 8px;
      padding: 8px 10px;
      border-radius: 10px;
      background: #fffbeb;
      border: 1px solid #facc15;
      color: #78350f;
      font-size: 11px;
    }
    .help-box-yellow ol {
      padding-left: 18px;
      margin: 4px 0 0;
    }
    .help-box-yellow li {
      margin: 2px 0;
    }

    .status {
      font-size: 11px;
      margin-top: 6px;
      padding: 4px 8px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .status.info {
      color: #2563eb;
      background: #dbeafe;
      border: 1px solid #bfdbfe;
    }
    .status.success {
      color: #15803d;
      background: #dcfce7;
      border: 1px solid #bbf7d0;
    }
    .status.error {
      color: #b91c1c;
      background: #fee2e2;
      border: 1px solid #fecaca;
    }

    /* ì´ë¯¸ì§€ ë“œë¡­ì¡´ & ë¯¸ë¦¬ë³´ê¸° */
    .dropzone {
      margin-top: 4px;
      padding: 10px;
      border-radius: 10px;
      border: 1px dashed #d1d5db;
      font-size: 11px;
      color: #6b7280;
      text-align: center;
      background: #f9fafb;
      cursor: pointer;
    }
    .dropzone.dragover {
      border-color: #111827;
      background: #e5e7eb;
    }
    .image-preview {
      margin-top: 6px;
      max-width: 100%;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <h1>ì—¬í–‰ ë¦¬ë” ê´€ë¦¬ì í˜ì´ì§€ (ê´‘ê³  + JSON ìƒì„±ê¸°)</h1>
      <p>ì´ í˜ì´ì§€ì—ì„œ ê´‘ê³  ë°°ë„ˆì™€ ë¦¬ë” ì •ë³´ë¥¼ ê´€ë¦¬í•˜ê³ , leaders.jsonì„ ìƒì„±í•˜ì—¬ so.t-leader-choice ê³µê°œ í˜ì´ì§€ì— ë°˜ì˜í•©ë‹ˆë‹¤.</p>
    </header>

    <div class="layout">
      <!-- ì™¼ìª½ : ì…ë ¥ í¼ë“¤ -->
      <div>
        <!-- ê´‘ê³  ë°°ë„ˆ ê´€ë¦¬ -->
        <section class="card">
          <div class="card-header">
            <div>
              <div class="card-title">ê´‘ê³  ë°°ë„ˆ ê´€ë¦¬</div>
              <div class="card-subtitle">ë°°ë„ˆ ê´‘ê³  í…ìŠ¤íŠ¸ì™€ ë§í¬, ë…¸ì¶œ ì—¬ë¶€ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.</div>
            </div>
          </div>
          <div class="form-grid">
            <div class="form-row">
              <label class="label-sm" for="ad-title">ê´‘ê³  ì œëª©</label>
              <input id="ad-title" class="input" type="text" placeholder="ì˜ˆ) ê´‘ê³  1, ì–´ìŠ¬ë  ì—¬í–‰" />
            </div>
            <div class="form-row">
              <label class="label-sm" for="ad-text">ê´‘ê³  ë¬¸êµ¬ / ì„¤ëª…</label>
              <textarea id="ad-text" class="textarea" placeholder="ì§§ì€ í•œ ì¤„ ë˜ëŠ” ë‘ ì¤„ ì„¤ëª…"></textarea>
            </div>
            <div class="form-row">
              <label class="label-sm" for="ad-url">ê´‘ê³  ë§í¬ URL (ì˜ˆ: YouTube, ì‚¬ì´íŠ¸ ë“±)</label>
              <input id="ad-url" class="input" type="text" placeholder="https://..." />
            </div>

            <!-- ë°°ë„ˆ ì´ë¯¸ì§€: URL + íŒŒì¼ ì„ íƒ/ë“œë˜ê·¸ -->
            <div class="form-row">
              <label class="label-sm" for="ad-image-url">ë°°ë„ˆ ì´ë¯¸ì§€ (URL ë˜ëŠ” íŒŒì¼)</label>
              <input id="ad-image-url" class="input" type="text" placeholder="images/banner.jpg ë˜ëŠ” https://.../banner.jpg" />
              <div class="button-row" style="margin-top:4px;">
                <button id="ad-image-file-trigger" class="btn" type="button">ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ / ë“œë˜ê·¸</button>
              </div>
              <input id="ad-image-file" type="file" accept="image/*" style="display:none;" />
              <div id="ad-image-drop" class="dropzone">
                ì´ ì˜ì—­ì„ í´ë¦­í•˜ê±°ë‚˜, ë°°ë„ˆ ì´ë¯¸ì§€ë¥¼ ëŒì–´ë‹¤ ë†“ìœ¼ë©´ ì„ íƒë©ë‹ˆë‹¤.
              </div>
              <img id="ad-image-preview" class="image-preview" alt="" style="display:none;" />
              <div class="help-text">
                â€» ì„ íƒí•œ íŒŒì¼ ì´ë¦„ ê¸°ì¤€ìœ¼ë¡œ <code>images/íŒŒì¼ì´ë¦„</code> í˜•ì‹ìœ¼ë¡œ URLì´ ìë™ ì…ë ¥ë©ë‹ˆë‹¤. (ì´ë¯¸ì§€ëŠ” GitHub ë ˆí¬ì˜ images í´ë”ì— ë”°ë¡œ ì—…ë¡œë“œí•´ì•¼ ì‹¤ì œ í˜ì´ì§€ì—ì„œ ë³´ì…ë‹ˆë‹¤.)
              </div>
            </div>

            <div class="form-row">
              <label class="label-sm" for="ad-position">ë…¸ì¶œ ìœ„ì¹˜</label>
              <select id="ad-position" class="input">
                <option value="top">ìƒë‹¨</option>
                <option value="bottom" selected>í•˜ë‹¨</option>
              </select>
            </div>
            <div class="checkbox-row">
              <input id="ad-visible" type="checkbox" checked />
              <label for="ad-visible">ì´ ê´‘ê³  ë…¸ì¶œ</label>
            </div>
          </div>
          <div class="button-row">
            <button id="ad-save-btn" class="btn btn-primary">ê´‘ê³  ì €ì¥</button>
            <button id="ad-reset-btn" class="btn btn-outline" type="button">ê´‘ê³  í¼ ì´ˆê¸°í™”</button>
          </div>
        </section>

        <!-- ë¦¬ë” ì •ë³´ ì…ë ¥ / ìˆ˜ì • -->
        <section class="card">
          <div class="card-header">
            <div>
              <div class="card-title">ë¦¬ë” ì •ë³´ ì…ë ¥ / ìˆ˜ì •</div>
              <div class="card-subtitle">ë¦¬ë” ì¹´ë“œì— í‘œì‹œë  ê¸°ë³¸ ì •ë³´ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.</div>
            </div>
          </div>
          <div class="form-grid">
            <div class="form-row">
              <label class="label-sm" for="leader-name">ì´ë¦„</label>
              <input id="leader-name" class="input" type="text" placeholder="ì˜ˆ) í•œê¸°ë¦¼" />
            </div>
            <div class="form-row">
              <label class="label-sm" for="leader-role">ì—­í•  / ì§í•¨</label>
              <input id="leader-role" class="input" type="text" placeholder="ì˜ˆ) ëŒ€ì¥ ì˜¤ë¡œë¼" />
            </div>
            <div class="form-row">
              <label class="label-sm" for="leader-headline">í•œ ì¤„ ì†Œê°œ / ì§§ì€ ì„¤ëª…</label>
              <textarea id="leader-headline" class="textarea" placeholder="ë¦¬ë”ë¥¼ í•œ ì¤„ë¡œ ì†Œê°œí•˜ëŠ” ë¬¸ì¥"></textarea>
            </div>
            <div class="form-row">
              <label class="label-sm" for="leader-form-url">ìƒë‹´ / ì‹ ì²­ ë§í¬ (êµ¬ê¸€í¼ URL)</label>
              <input id="leader-form-url" class="input" type="text" placeholder="https://docs.google.com/forms/..." />
            </div>
            <div class="form-row">
              <label class="label-sm" for="leader-sheet-url">ì‘ë‹µ ì‹œíŠ¸ ë§í¬ (êµ¬ê¸€ ì‹œíŠ¸ URL)</label>
              <input id="leader-sheet-url" class="input" type="text" placeholder="https://docs.google.com/spreadsheets/..." />
            </div>
            <div class="form-row">
              <label class="label-sm" for="leader-tags">í‚¤ì›Œë“œ íƒœê·¸ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
              <input id="leader-tags" class="input" type="text" placeholder="ì˜ˆ) ìœ ëŸ½, ììœ ì—¬í–‰, ì†Œê·œëª¨, ê°ì„±" />
            </div>
            <div class="form-row">
              <label class="label-sm" for="leader-intro">ìì„¸í•œ ì„¤ëª… / ì†Œê°œê¸€</label>
              <textarea id="leader-intro" class="textarea" placeholder="ì¹´ë“œ í•˜ë‹¨ì— ë“¤ì–´ê°ˆ ì¡°ê¸ˆ ë” ê¸´ ì†Œê°œê¸€"></textarea>
            </div>
          </div>
        </section>

        <!-- ë¦¬ë” SNS + ì´ë¯¸ì§€ -->
        <section class="card">
          <div class="card-header">
            <div>
              <div class="card-title">ë¦¬ë” SNS ì±„ë„ / ì´ë¯¸ì§€</div>
              <div class="card-subtitle">SNS ë§í¬ì™€ ì¹´ë“œì— ì‚¬ìš©í•  ì´ë¯¸ì§€ URLì„ ì…ë ¥í•©ë‹ˆë‹¤.</div>
            </div>
          </div>
          <div class="form-grid">
            <div class="form-row">
              <label class="label-sm" for="leader-youtube">YouTube URL</label>
              <input id="leader-youtube" class="input" type="text" placeholder="https://www.youtube.com/..." />
            </div>
            <div class="form-row">
              <label class="label-sm" for="leader-tiktok">TikTok URL</label>
              <input id="leader-tiktok" class="input" type="text" placeholder="https://www.tiktok.com/..." />
            </div>
            <div class="form-row">
              <label class="label-sm" for="leader-instagram">Instagram URL</label>
              <input id="leader-instagram" class="input" type="text" placeholder="https://www.instagram.com/..." />
            </div>
            <div class="form-row">
              <label class="label-sm" for="leader-facebook">Facebook URL</label>
              <input id="leader-facebook" class="input" type="text" placeholder="https://www.facebook.com/..." />
            </div>
            <div class="form-row">
              <label class="label-sm" for="leader-blog">Blog URL</label>
              <input id="leader-blog" class="input" type="text" placeholder="https://blog.naver.com/..." />
            </div>

            <!-- ë¦¬ë” ì´ë¯¸ì§€: URL + íŒŒì¼ ì„ íƒ/ë“œë˜ê·¸ -->
            <div class="form-row">
              <label class="label-sm" for="leader-image-url">í”„ë¡œí•„ ì´ë¯¸ì§€ (URL ë˜ëŠ” íŒŒì¼)</label>
              <input id="leader-image-url" class="input" type="text" placeholder="images/leader.jpg ë˜ëŠ” https://.../leader.jpg" />
              <div class="button-row" style="margin-top:4px;">
                <button id="leader-image-file-trigger" class="btn" type="button">ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ / ë“œë˜ê·¸</button>
              </div>
              <input id="leader-image-file" type="file" accept="image/*" style="display:none;" />
              <div id="leader-image-drop" class="dropzone">
                ì´ ì˜ì—­ì„ í´ë¦­í•˜ê±°ë‚˜, ë¦¬ë” í”„ë¡œí•„ ì´ë¯¸ì§€ë¥¼ ëŒì–´ë‹¤ ë†“ìœ¼ë©´ ì„ íƒë©ë‹ˆë‹¤.
              </div>
              <img id="leader-image-preview" class="image-preview" alt="" style="display:none;" />
              <div class="help-text">
                â€» ì„ íƒí•œ íŒŒì¼ ì´ë¦„ ê¸°ì¤€ìœ¼ë¡œ <code>images/íŒŒì¼ì´ë¦„</code> í˜•ì‹ìœ¼ë¡œ URLì´ ìë™ ì…ë ¥ë©ë‹ˆë‹¤. (ì´ë¯¸ì§€ëŠ” GitHub ë ˆí¬ì˜ images í´ë”ì— ë”°ë¡œ ì—…ë¡œë“œí•´ì•¼ ì‹¤ì œ í˜ì´ì§€ì—ì„œ ë³´ì…ë‹ˆë‹¤.)
              </div>
            </div>

            <div class="form-row">
              <label class="label-sm" for="leader-order">ë…¸ì¶œ ìˆœì„œ (ìˆ«ì, ì‘ì„ìˆ˜ë¡ ë¨¼ì €)</label>
              <input id="leader-order" class="input" type="number" min="1" step="1" placeholder="ì˜ˆ) 1" />
            </div>
            <div class="checkbox-row">
              <input id="leader-visible" type="checkbox" checked />
              <label for="leader-visible">ì´ ë¦¬ë” ë…¸ì¶œ</label>
            </div>
          </div>
          <div class="button-row">
            <button id="leader-save-btn" class="btn btn-primary">ë¦¬ë” ì €ì¥</button>
            <button id="leader-reset-btn" class="btn btn-outline" type="button">ë¦¬ë” í¼ ì´ˆê¸°í™”</button>
          </div>
        </section>
      </div>

      <!-- ì˜¤ë¥¸ìª½ : ë¦¬ìŠ¤íŠ¸ + JSON -->
      <div>
        <!-- ê´‘ê³  ë¦¬ìŠ¤íŠ¸ -->
        <section class="card">
          <div class="card-header">
            <div>
              <div class="card-title">ê´‘ê³  ë¦¬ìŠ¤íŠ¸</div>
              <div class="card-subtitle">ì €ì¥ëœ ê´‘ê³  ë°°ë„ˆ ëª©ë¡ì…ë‹ˆë‹¤.</div>
            </div>
          </div>
          <div id="ad-list" class="list"></div>
          <div class="help-text">
            â€» ê´‘ê³ ë¥¼ ìˆ˜ì •í•˜ë ¤ë©´ ì˜¤ë¥¸ìª½ì˜ <b>ìˆ˜ì •</b> ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìœ„ ê´‘ê³  í¼ì— ê°’ì´ ì±„ì›Œì§‘ë‹ˆë‹¤.
          </div>
        </section>

        <!-- ë¦¬ë” ë¦¬ìŠ¤íŠ¸ -->
        <section class="card">
          <div class="card-header">
            <div>
              <div class="card-title">ë¦¬ë” ë¦¬ìŠ¤íŠ¸</div>
              <div class="card-subtitle">ì €ì¥ëœ ì—¬í–‰ ë¦¬ë” ëª©ë¡ì…ë‹ˆë‹¤.</div>
            </div>
            <div style="display:flex; align-items:center; gap:8px; flex-wrap:wrap;">
              <div class="badge badge-on">í˜„ì¬ ë¦¬ë” ìˆ˜: <span id="leader-count">0</span>ëª…</div>
              <button id="leader-new-btn" class="btn btn-outline" type="button">+ ìƒˆ ë¦¬ë” ì¶”ê°€</button>
            </div>
          </div>
          <div id="leader-list" class="list"></div>
          <div class="help-text">
            â€» <b>ë…¸ì¶œ ë„ê¸°</b> ë²„íŠ¼ìœ¼ë¡œ í˜ì´ì§€ì— ì•ˆ ë³´ì´ê²Œ í•  ìˆ˜ ìˆê³ , <b>ìˆ˜ì •</b>ì„ ëˆ„ë¥´ë©´ ì™¼ìª½ í¼ì— ê°’ì´ ì±„ì›Œì§‘ë‹ˆë‹¤.
          </div>
        </section>

        <!-- JSON ìƒì„± / ë³µì‚¬ / ë¶ˆëŸ¬ì˜¤ê¸° -->
        <section class="card">
          <div class="card-header">
            <div>
              <div class="card-title">leaders.json ìƒì„± / ë³µì‚¬ / ë¶ˆëŸ¬ì˜¤ê¸°</div>
              <div class="card-subtitle">ê´‘ê³  + ë¦¬ë” ì •ë³´ë¡œ leaders.jsonì„ ë§Œë“¤ê±°ë‚˜, ê¸°ì¡´ JSONì„ ë¶ˆëŸ¬ì™€ ê´€ë¦¬ìì— ë®ì–´ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
            </div>
          </div>

          <div class="button-row">
            <button id="json-generate-btn" class="btn btn-primary" type="button">JSON ìƒì„±í•˜ê¸°</button>
            <button id="json-copy-btn" class="btn" type="button">JSON ë³µì‚¬í•˜ê¸°</button>
          </div>
          <div class="button-row" style="margin-top:6px;">
            <button id="json-file-btn" class="btn" type="button">JSON íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°</button>
            <button id="json-apply-btn" class="btn btn-outline" type="button">JSON â†’ ê´€ë¦¬ìì— ë®ì–´ì“°ê¸°</button>
          </div>
          <div class="button-row" style="margin-top:6px;">
            <a class="btn btn-outline" href="https://github.com/wordycow/so.t-leader-choice/blob/main/leaders.json" target="_blank" rel="noopener noreferrer">GitHub leaders.json ì—´ê¸°</a>
          </div>
          
                    <!-- ğŸ” êµ¬ê¸€í¼ URL ì¼ê´„ ì…ë ¥ -->
          <div class="form-grid" style="margin-top:8px;">
            <div class="form-row">
              <label class="label-sm" for="bulk-form-urls">
                ìƒë‹´ / ì‹ ì²­ êµ¬ê¸€í¼ URL ì¼ê´„ ì…ë ¥ (ê° ì¤„ë§ˆë‹¤ 1ê°œ URL)
              </label>
              <textarea
                id="bulk-form-urls"
                class="textarea"
                placeholder="https://docs.google.com/forms/...=í•œê¸°ë¦¼&#10;https://docs.google.com/forms/...=ì„ì •ì• &#10;https://docs.google.com/forms/...=ìœ¤ì§€ë¯¼&#10;..."
              ></textarea>
              <div class="button-row" style="margin-top:6px;">
                <button id="apply-bulk-form-urls" class="btn btn-outline" type="button">
                  URL â†’ ë¦¬ë”ì— ìë™ ë§¤ì¹­
                </button>
              </div>
              <div id="bulk-form-urls-status" class="help-text"></div>
            </div>
          </div>

          <textarea id="json-textarea" class="json-textarea" placeholder='{
  "ads": [],
  "leaders": []
}'></textarea>

          <input id="json-file-input" type="file" accept=".json,application/json" style="display:none;" />

          <div id="json-status" class="status info">leaders.json ë‚´ìš©ì„ ì´ê³³ì—ì„œ ìƒì„±í•˜ê±°ë‚˜ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>

          <div class="help-box-yellow">
            <strong>[GitHubì— leaders.json ë¶™ì—¬ ë„£ëŠ” ë°©ë²•]</strong>
            <ol>
              <li><b>JSON ìƒì„±í•˜ê¸°</b>ë¥¼ ëˆŒëŸ¬ í˜„ì¬ ê´‘ê³ /ë¦¬ë” ëª©ë¡ ê¸°ì¤€ìœ¼ë¡œ JSONì„ ë§Œë“­ë‹ˆë‹¤.</li>
              <li><b>JSON ë³µì‚¬í•˜ê¸°</b> ë²„íŠ¼ì„ ëˆŒëŸ¬ leaders.json ë‚´ìš©ì„ í´ë¦½ë³´ë“œì— ë³µì‚¬í•©ë‹ˆë‹¤.</li>
              <li><b>GitHub leaders.json ì—´ê¸°</b> ë²„íŠ¼ì„ ëˆŒëŸ¬ GitHubì˜ leaders.json í¸ì§‘ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.</li>
              <li>GitHubì—ì„œ ë‚´ìš© ì „ì²´ ì„ íƒ(Ctrl+A) í›„ ì‚­ì œ â†’ ë³µì‚¬í•œ JSONì„ ë¶™ì—¬ ë„£ê¸°(Ctrl+V) í•©ë‹ˆë‹¤.</li>
              <li>ì•„ë˜ìª½ <b>Commit changes</b> ë²„íŠ¼ì„ ëˆŒëŸ¬ ì €ì¥í•©ë‹ˆë‹¤.</li>
              <li>ê³µê°œ í˜ì´ì§€(<code>https://wordycow.github.io/so.t-leader-choice/</code>)ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ëª¨ë“  ì‚¬ìš©ìê°€ ë™ì¼í•œ ì •ë³´ë¥¼ ë³´ê²Œ ë©ë‹ˆë‹¤.</li>
            </ol>
          </div>
        </section>
      </div>
    </div>
  </div>

    <script>
    // =============================
    // ì „ì—­ ìƒíƒœ
    // =============================
    const state = {
      ads: [],
      leaders: [],
      editingAdIndex: null,
      editingLeaderIndex: null
    };

    document.addEventListener("DOMContentLoaded", () => {
      initAdForm();
      initLeaderForm();
      initJsonSection();
      initImagePickers();
      initImageUrlPreview();
      renderAds();
      renderLeaders();
    });

    // =============================
    // ê´‘ê³  í¼
    // =============================
    function initAdForm() {
      const saveBtn = document.getElementById("ad-save-btn");
      const resetBtn = document.getElementById("ad-reset-btn");

      saveBtn.addEventListener("click", () => {
        const ad = getAdFormData();
        if (!ad.title && !ad.text && !ad.url) {
          alert("ìµœì†Œí•œ ê´‘ê³  ì œëª© ë˜ëŠ” ë¬¸êµ¬, ë§í¬ ì¤‘ í•˜ë‚˜ëŠ” ì…ë ¥í•´ì•¼ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
          return;
        }

        if (state.editingAdIndex === null) {
          state.ads.push(ad);
        } else {
          state.ads[state.editingAdIndex] = ad;
        }
        state.editingAdIndex = null;
        clearAdForm();
        renderAds();
      });

      resetBtn.addEventListener("click", () => {
        state.editingAdIndex = null;
        clearAdForm();
      });
    }

    function getAdFormData() {
      const title = document.getElementById("ad-title").value.trim();
      const text = document.getElementById("ad-text").value.trim();
      const url = document.getElementById("ad-url").value.trim();
      const imageUrl = document.getElementById("ad-image-url").value.trim();
      const position = document.getElementById("ad-position").value;
      const visible = document.getElementById("ad-visible").checked;

      const id =
        state.editingAdIndex !== null && state.ads[state.editingAdIndex]
          ? state.ads[state.editingAdIndex].id
          : generateId("ad");

      return {
        id,
        title,
        text,
        url,
        imageUrl,
        position,
        visible
      };
    }

    function setAdFormData(ad) {
      document.getElementById("ad-title").value = ad.title || "";
      document.getElementById("ad-text").value = ad.text || "";
      document.getElementById("ad-url").value = ad.url || "";
      document.getElementById("ad-image-url").value = ad.imageUrl || "";
      document.getElementById("ad-position").value = ad.position || "bottom";
      document.getElementById("ad-visible").checked = ad.visible !== false;
      updateAdPreviewFromUrl();
    }

    function clearAdForm() {
      document.getElementById("ad-title").value = "";
      document.getElementById("ad-text").value = "";
      document.getElementById("ad-url").value = "";
      document.getElementById("ad-image-url").value = "";
      document.getElementById("ad-position").value = "bottom";
      document.getElementById("ad-visible").checked = true;

      const preview = document.getElementById("ad-image-preview");
      preview.style.display = "none";
      preview.src = "";
    }

    function renderAds() {
      const list = document.getElementById("ad-list");
      list.innerHTML = "";

      if (!state.ads.length) {
        const empty = document.createElement("div");
        empty.className = "help-text";
        empty.textContent = "ë“±ë¡ëœ ê´‘ê³ ê°€ ì—†ìŠµë‹ˆë‹¤. ì™¼ìª½ í¼ì—ì„œ ê´‘ê³ ë¥¼ ì¶”ê°€í•´ ì£¼ì„¸ìš”.";
        list.appendChild(empty);
        return;
      }

      state.ads.forEach((ad, index) => {
        const item = document.createElement("div");
        item.className = "list-item";

        const top = document.createElement("div");
        top.className = "list-top";

        const left = document.createElement("div");
        left.className = "list-top-left";

        if (ad.imageUrl) {
          const thumb = document.createElement("img");
          thumb.className = "list-thumb";
          thumb.src = ad.imageUrl;
          thumb.alt = ad.title || "ê´‘ê³  ì´ë¯¸ì§€";
          left.appendChild(thumb);
        }

        const title = document.createElement("div");
        title.className = "list-title";
        title.textContent = ad.title || "(ì œëª© ì—†ìŒ)";
        left.appendChild(title);

        const badge = document.createElement("span");
        const isVisible = ad.visible !== false;
        badge.className = "badge " + (isVisible ? "badge-on" : "badge-off");
        badge.textContent = isVisible ? "ë…¸ì¶œ ì¤‘" : "ë…¸ì¶œ ë”";

        top.appendChild(left);
        top.appendChild(badge);

            const sub = document.createElement("div");
    sub.className = "list-sub";
    const tagsText =
      Array.isArray(leader.tags) && leader.tags.length
        ? "íƒœê·¸: " + leader.tags.join(", ")
        : "íƒœê·¸ ì—†ìŒ";
    sub.textContent = (leader.role ? leader.role + " Â· " : "") + tagsText;

    // ìƒë‹´ ë§í¬ / ì‹œíŠ¸ ë§í¬ ì§§ì€ í…ìŠ¤íŠ¸ë¡œ
    const linkDiv = document.createElement("div");
    linkDiv.className = "list-sub";

    const formUrl  = leader.formUrl || leader.link || "";
    const sheetUrl = leader.sheetUrl || "";

    let linkHtml = "";

    if (formUrl) {
      linkHtml += `<a href="${formUrl}" target="_blank" rel="noopener noreferrer" style="color:#2563eb;text-decoration:underline;font-size:11px;">ìƒë‹´ / ì‹ ì²­ ë§í¬ ì—´ê¸°</a>`;
    }
    if (sheetUrl) {
      if (linkHtml) linkHtml += " Â· ";
      linkHtml += `<a href="${sheetUrl}" target="_blank" rel="noopener noreferrer" style="color:#16a34a;text-decoration:underline;font-size:11px;">ì‘ë‹µ ì‹œíŠ¸ ì—´ê¸°</a>`;
    }
    if (!linkHtml) {
      linkHtml = `<span style="font-size:10px;color:#9ca3af;">ìƒë‹´ ë§í¬ ì—†ìŒ</span>`;
    }
    linkDiv.innerHTML = linkHtml;


        const url = document.createElement("div");
        url.className = "list-sub";
        url.textContent = ad.url || "";

        const actions = document.createElement("div");
        actions.className = "list-actions";

        const toggleBtn = document.createElement("button");
        toggleBtn.className = "btn";
        toggleBtn.textContent = isVisible ? "ë…¸ì¶œ ë„ê¸°" : "ë…¸ì¶œ ì¼œê¸°";
        toggleBtn.addEventListener("click", () => {
          const current = state.ads[index].visible !== false;
          state.ads[index].visible = !current;
          renderAds();
        });

        const editBtn = document.createElement("button");
        editBtn.className = "btn";
        editBtn.textContent = "ìˆ˜ì •";
        editBtn.addEventListener("click", () => {
          state.editingAdIndex = index;
          setAdFormData(ad);
          window.scrollTo({ top: 0, behavior: "smooth" });
        });

        const deleteBtn = document.createElement("button");
        deleteBtn.className = "btn btn-danger";
        deleteBtn.textContent = "ì‚­ì œ";
        deleteBtn.addEventListener("click", () => {
          if (confirm("ì´ ê´‘ê³ ë¥¼ ì‚­ì œí• ê¹Œìš”?")) {
            state.ads.splice(index, 1);
            state.editingAdIndex = null;
            clearAdForm();
            renderAds();
          }
        });

        actions.appendChild(toggleBtn);
        actions.appendChild(editBtn);
        actions.appendChild(deleteBtn);

            item.appendChild(top);
    item.appendChild(sub);
    item.appendChild(linkDiv);
    item.appendChild(actions);


        list.appendChild(item);
      });
    }

    // =============================
    // ë¦¬ë” í¼
    // =============================
    function initLeaderForm() {
      const saveBtn = document.getElementById("leader-save-btn");
      const resetBtn = document.getElementById("leader-reset-btn");
      const newBtn = document.getElementById("leader-new-btn");

      saveBtn.addEventListener("click", () => {
        const leader = getLeaderFormData();
        if (!leader.name) {
          alert("ë¦¬ë” ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.");
          return;
        }

        if (state.editingLeaderIndex === null) {
          state.leaders.push(leader);
        } else {
          state.leaders[state.editingLeaderIndex] = leader;
        }
        state.editingLeaderIndex = null;
        clearLeaderForm();
        renderLeaders();
      });

      resetBtn.addEventListener("click", () => {
        state.editingLeaderIndex = null;
        clearLeaderForm();
      });

      if (newBtn) {
        newBtn.addEventListener("click", () => {
          state.editingLeaderIndex = null;
          clearLeaderForm();
          const nameInput = document.getElementById("leader-name");
          if (nameInput) {
            nameInput.scrollIntoView({ behavior: "smooth", block: "start" });
            nameInput.focus();
          }
        });
      }
    }

    function getLeaderFormData() {
      const name = document.getElementById("leader-name").value.trim();
      const role = document.getElementById("leader-role").value.trim();
      const headline = document.getElementById("leader-headline").value.trim();
      const formUrl = document.getElementById("leader-form-url").value.trim();
      const sheetUrl = document.getElementById("leader-sheet-url").value.trim();
      const tagsStr = document.getElementById("leader-tags").value.trim();
      const intro = document.getElementById("leader-intro").value.trim();

      const youtube = document.getElementById("leader-youtube").value.trim();
      const tiktok = document.getElementById("leader-tiktok").value.trim();
      const instagram = document.getElementById("leader-instagram").value.trim();
      const facebook = document.getElementById("leader-facebook").value.trim();
      const blog = document.getElementById("leader-blog").value.trim();

      const imageUrl = document.getElementById("leader-image-url").value.trim();
      const orderVal = document.getElementById("leader-order").value;
      const visible = document.getElementById("leader-visible").checked;

      const tags = tagsStr
        ? tagsStr.split(",").map(t => t.trim()).filter(Boolean)
        : [];

      const id =
        state.editingLeaderIndex !== null && state.leaders[state.editingLeaderIndex]
          ? state.leaders[state.editingLeaderIndex].id
          : generateId("leader");

      return {
        id,
        name,
        role,
        headline,
        formUrl,
        sheetUrl,
        tags,
        intro,
        sns: { youtube, tiktok, instagram, facebook, blog },
        imageUrl,
        order: orderVal ? Number(orderVal) : null,
        visible
      };
    }

    function setLeaderFormData(leader) {
      document.getElementById("leader-name").value = leader.name || "";
      document.getElementById("leader-role").value = leader.role || "";
      document.getElementById("leader-headline").value = leader.headline || "";
      document.getElementById("leader-form-url").value = leader.formUrl || "";
      document.getElementById("leader-sheet-url").value = leader.sheetUrl || "";
      document.getElementById("leader-tags").value = Array.isArray(leader.tags)
        ? leader.tags.join(", ")
        : "";
      document.getElementById("leader-intro").value = leader.intro || "";

      document.getElementById("leader-youtube").value = leader.sns?.youtube || "";
      document.getElementById("leader-tiktok").value = leader.sns?.tiktok || "";
      document.getElementById("leader-instagram").value = leader.sns?.instagram || "";
      document.getElementById("leader-facebook").value = leader.sns?.facebook || "";
      document.getElementById("leader-blog").value = leader.sns?.blog || "";

      document.getElementById("leader-image-url").value = leader.imageUrl || "";
      document.getElementById("leader-order").value = leader.order ?? "";
      document.getElementById("leader-visible").checked = leader.visible !== false;

      updateLeaderPreviewFromUrl();
    }

    function clearLeaderForm() {
      document.getElementById("leader-name").value = "";
      document.getElementById("leader-role").value = "";
      document.getElementById("leader-headline").value = "";
      document.getElementById("leader-form-url").value = "";
      document.getElementById("leader-sheet-url").value = "";
      document.getElementById("leader-tags").value = "";
      document.getElementById("leader-intro").value = "";

      document.getElementById("leader-youtube").value = "";
      document.getElementById("leader-tiktok").value = "";
      document.getElementById("leader-instagram").value = "";
      document.getElementById("leader-facebook").value = "";
      document.getElementById("leader-blog").value = "";

      document.getElementById("leader-image-url").value = "";
      document.getElementById("leader-order").value = "";
      document.getElementById("leader-visible").checked = true;

      const preview = document.getElementById("leader-image-preview");
      preview.style.display = "none";
      preview.src = "";
    }

    function renderLeaders() {
  const list = document.getElementById("leader-list");
  const countEl = document.getElementById("leader-count");
  list.innerHTML = "";

  // JSON â†’ ê´€ë¦¬ìì— ë®ì–´ì“´ ë’¤ì˜ state.leaders ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬
  const leadersSorted = [...state.leaders].sort((a, b) => {
    const ao = a.order ?? 9999;
    const bo = b.order ?? 9999;
    if (ao === bo) return (a.name || "").localeCompare(b.name || "", "ko");
    return ao - bo;
  });

  countEl.textContent = leadersSorted.length;

  if (!leadersSorted.length) {
    const empty = document.createElement("div");
    empty.className = "help-text";
    empty.textContent = "ë“±ë¡ëœ ë¦¬ë”ê°€ ì—†ìŠµë‹ˆë‹¤. ì™¼ìª½ í¼ì—ì„œ ë¦¬ë”ë¥¼ ì¶”ê°€í•´ ì£¼ì„¸ìš”.";
    list.appendChild(empty);
    return;
  }

  leadersSorted.forEach((leader) => {
    const originalIndex = state.leaders.indexOf(leader);

    const item = document.createElement("div");
    item.className = "list-item";

    const top = document.createElement("div");
    top.className = "list-top";

    const left = document.createElement("div");
    left.className = "list-top-left";

    // ğŸ”¥ ì—¬ê¸°! ê´‘ê³  ë¦¬ìŠ¤íŠ¸ì²˜ëŸ¼ ì¸ë„¤ì¼ ì†ŒìŠ¤ë§Œ ë½‘ì•„ì„œ ì”€
    //  - ìƒˆ adminì—ì„œ ì“°ëŠ” imageUrl
    //  - ì˜ˆì „ adminì—ì„œ ì“°ë˜ mediaUrl ë‘˜ ë‹¤ ì§€ì›
    const thumbSrc = leader.imageUrl || leader.mediaUrl;

    if (thumbSrc) {
      const thumb = document.createElement("img");
      thumb.className = "list-thumb";      // ê´‘ê³  ì¸ë„¤ì¼ê³¼ ê°™ì€ ìŠ¤íƒ€ì¼
      thumb.src = thumbSrc;
      thumb.alt = leader.name || "ë¦¬ë” ì´ë¯¸ì§€";
      left.appendChild(thumb);
    }

    const title = document.createElement("div");
    title.className = "list-title";
    title.textContent = leader.name || "(ì´ë¦„ ì—†ìŒ)";
    left.appendChild(title);

    const badge = document.createElement("span");
    const isVisible = leader.visible !== false;
    badge.className = "badge " + (isVisible ? "badge-on" : "badge-off");
    badge.textContent = isVisible ? "ë…¸ì¶œ" : "ìˆ¨ê¹€";

    top.appendChild(left);
    top.appendChild(badge);

    const sub = document.createElement("div");
    sub.className = "list-sub";
    const tagsText =
      Array.isArray(leader.tags) && leader.tags.length
        ? "íƒœê·¸: " + leader.tags.join(", ")
        : "íƒœê·¸ ì—†ìŒ";
    sub.textContent = (leader.role ? leader.role + " Â· " : "") + tagsText;

    const linkDiv = document.createElement("div");
    linkDiv.className = "list-sub";
    // ì˜ˆì „ JSON ì€ link, ì§€ê¸ˆ ê±´ formUrl ë¥¼ ì“°ê³  ìˆì„ ìˆ˜ ìˆì–´ì„œ ë‘˜ ë‹¤ ì²´í¬
    linkDiv.textContent = leader.formUrl || leader.link || "";

    const actions = document.createElement("div");
    actions.className = "list-actions";

    const toggleBtn = document.createElement("button");
    toggleBtn.className = "btn";
    toggleBtn.textContent = isVisible ? "ë…¸ì¶œ ë„ê¸°" : "ë…¸ì¶œ ì¼œê¸°";
    toggleBtn.addEventListener("click", () => {
      const target = state.leaders[originalIndex];
      const curr = target.visible !== false;
      target.visible = !curr;
      renderLeaders();
    });

    const editBtn = document.createElement("button");
    editBtn.className = "btn";
    editBtn.textContent = "ìˆ˜ì •";
    editBtn.addEventListener("click", () => {
      state.editingLeaderIndex = originalIndex;
      setLeaderFormData(leader);
      const nameInput = document.getElementById("leader-name");
      if (nameInput) {
        nameInput.scrollIntoView({ behavior: "smooth", block: "start" });
        nameInput.focus();
      }
    });

    const deleteBtn = document.createElement("button");
    deleteBtn.className = "btn btn-danger";
    deleteBtn.textContent = "ì‚­ì œ";
    deleteBtn.addEventListener("click", () => {
      if (confirm("ì´ ë¦¬ë”ë¥¼ ì‚­ì œí• ê¹Œìš”?")) {
        state.leaders.splice(originalIndex, 1);
        state.editingLeaderIndex = null;
        clearLeaderForm();
        renderLeaders();
      }
    });

    actions.appendChild(toggleBtn);
    actions.appendChild(editBtn);
    actions.appendChild(deleteBtn);

    item.appendChild(top);
    item.appendChild(sub);
    if (leader.formUrl || leader.link) item.appendChild(linkDiv);
    item.appendChild(actions);

    list.appendChild(item);
  });
}


    // =============================
    // JSON ì„¹ì…˜
    // =============================
    function initJsonSection() {
  const jsonTextarea = document.getElementById("json-textarea");
  const generateBtn  = document.getElementById("json-generate-btn");
  const copyBtn      = document.getElementById("json-copy-btn");
  const fileBtn      = document.getElementById("json-file-btn");
  const applyBtn     = document.getElementById("json-apply-btn");
  const fileInput    = document.getElementById("json-file-input");

  // ğŸ” ì—‘ì…€ â†’ URL ì¼ê´„ ì…ë ¥ìš©
  const bulkTextarea = document.getElementById("bulk-form-urls");
  const bulkBtn      = document.getElementById("apply-bulk-form-urls");
  const bulkStatus   = document.getElementById("bulk-form-urls-status");

  // JSON ìƒì„±
  generateBtn.addEventListener("click", () => {
    const obj = {
      ads: state.ads,
      leaders: state.leaders
    };
    jsonTextarea.value = JSON.stringify(obj, null, 2);
    setJsonStatus("í˜„ì¬ ê´€ë¦¬ì ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ JSONì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.", "success");
  });

  // JSON ë³µì‚¬
  copyBtn.addEventListener("click", () => {
    const text = jsonTextarea.value;
    if (!text.trim()) {
      setJsonStatus("ë³µì‚¬í•  JSON ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.", "error");
      return;
    }
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard
        .writeText(text)
        .then(() => setJsonStatus("JSONì„ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆìŠµë‹ˆë‹¤.", "success"))
        .catch(() => {
          fallbackCopy(text);
          setJsonStatus("ë¸Œë¼ìš°ì € ì œí•œìœ¼ë¡œ ê¸°ë³¸ ë³µì‚¬ ë°©ì‹ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.", "info");
        });
    } else {
      fallbackCopy(text);
      setJsonStatus("ë¸Œë¼ìš°ì € ì œí•œìœ¼ë¡œ ê¸°ë³¸ ë³µì‚¬ ë°©ì‹ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.", "info");
    }
  });

  // JSON íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
  fileBtn.addEventListener("click", () => {
    fileInput.click();
  });

  fileInput.addEventListener("change", () => {
    const file = fileInput.files && fileInput.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = () => {
      jsonTextarea.value = reader.result;
      setJsonStatus(
        "JSON íŒŒì¼ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤. ë‚´ìš©ì„ í™•ì¸í•œ í›„ â€œJSON â†’ ê´€ë¦¬ìì— ë®ì–´ì“°ê¸°â€ë¥¼ ëˆŒëŸ¬ ì ìš©í•˜ì„¸ìš”.",
        "info"
      );
      fileInput.value = "";
    };
    reader.onerror = () => {
      setJsonStatus("JSON íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", "error");
      fileInput.value = "";
    };
    reader.readAsText(file, "utf-8");
  });

  // JSON â†’ ê´€ë¦¬ìì— ë®ì–´ì“°ê¸°
  applyBtn.addEventListener("click", () => {
    const text = jsonTextarea.value.trim();
    if (!text) {
      setJsonStatus("ë®ì–´ì“¸ JSON ë‚´ìš©ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.", "error");
      return;
    }
    try {
      const parsed = JSON.parse(text);
      const root = parsed.data ? parsed.data : parsed;

      const adsRaw     = Array.isArray(root.ads) ? root.ads : [];
      const leadersRaw = Array.isArray(root.leaders) ? root.leaders : [];

      state.ads     = adsRaw.map((ad, idx) => normalizeAd(ad, idx));
      state.leaders = leadersRaw.map((leader, idx) => normalizeLeader(leader, idx));

      state.editingAdIndex     = null;
      state.editingLeaderIndex = null;

      clearAdForm();
      clearLeaderForm();
      renderAds();
      renderLeaders();

      setJsonStatus("JSON ë‚´ìš©ì„ ê´€ë¦¬ì ë°ì´í„°ì— ì„±ê³µì ìœ¼ë¡œ ë®ì–´ì¼ìŠµë‹ˆë‹¤.", "success");
    } catch (err) {
      setJsonStatus("JSON íŒŒì‹± ì˜¤ë¥˜: " + err.message, "error");
    }
  });

  // ğŸ” URL â†’ ë¦¬ë” ìë™ ë§¤ì¹­
  if (bulkBtn) {
    bulkBtn.addEventListener("click", () => {
      const raw = (bulkTextarea.value || "").trim();
      if (!raw) {
        bulkStatus.textContent = "URL ëª©ë¡ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.";
        return;
      }

      const lines = raw
        .split(/\r?\n/)
        .map(l => l.trim())
        .filter(Boolean);

      if (!lines.length) {
        bulkStatus.textContent = "ìœ íš¨í•œ URLì´ ì—†ìŠµë‹ˆë‹¤.";
        return;
      }

      // ì´ë¦„ â†’ ë¦¬ë” ì¸ë±ìŠ¤ ë§µ
      const nameIndexMap = new Map();
      state.leaders.forEach((leader, idx) => {
        if (leader && leader.name) {
          nameIndexMap.set(leader.name.trim(), idx);
        }
      });

      let matchedByName  = 0;
      let matchedByIndex = 0;
      const unmatched    = [];

      lines.forEach((line, idx) => {
        let name = null;

        // URL ì•ˆì˜ entry.xxxxx=ì´ë¦„ ì¶”ì¶œ
        try {
          const u = new URL(line);
          u.searchParams.forEach((val, key) => {
            if (!name && key.startsWith("entry.")) {
              name = decodeURIComponent(val);
            }
          });
        } catch (e) {
          // URL íŒŒì‹± ì‹¤íŒ¨ëŠ” ë¬´ì‹œ
        }

        let leaderIndex = -1;

        if (name && nameIndexMap.has(name)) {
          // ì´ë¦„ ë§¤ì¹­
          leaderIndex = nameIndexMap.get(name);
          matchedByName++;
        } else if (state.leaders[idx]) {
          // ì´ë¦„ì´ ì•ˆ ë§ìœ¼ë©´ ì¤„ ìˆœì„œëŒ€ë¡œ
          leaderIndex = idx;
          matchedByIndex++;
        } else {
          unmatched.push(line);
        }

        if (leaderIndex >= 0) {
          const leader = state.leaders[leaderIndex];
          leader.formUrl = line;   // ìƒˆ êµ¬ì¡°
          leader.link    = line;   // í˜¸í™˜ìš©
        }
      });

      renderLeaders();

      let msg = `ì´ë¦„ìœ¼ë¡œ ${matchedByName}ê°œ, ìˆœì„œë¡œ ${matchedByIndex}ê°œ ì ìš©í–ˆìŠµë‹ˆë‹¤.`;
      if (unmatched.length) {
        msg += ` (ë§¤ì¹­ ì‹¤íŒ¨ ${unmatched.length}ê°œëŠ” ë¬´ì‹œë¨)`;
      }
      bulkStatus.textContent = msg;
    });
  }
}
        if (!text) {
          setJsonStatus("ë®ì–´ì“¸ JSON ë‚´ìš©ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.", "error");
          return;
        }
        try {
          const parsed = JSON.parse(text);
          const root = parsed.data ? parsed.data : parsed;

          const adsRaw = Array.isArray(root.ads) ? root.ads : [];
          const leadersRaw = Array.isArray(root.leaders) ? root.leaders : [];

          // ì—¬ê¸°ì„œ ì˜›ë‚  / ìƒˆ JSON ëª¨ë‘ë¥¼ ì •ë¦¬í•´ì„œ stateë¡œ ë§Œë“¦
          state.ads = adsRaw.map((ad, idx) => normalizeAd(ad, idx));
          state.leaders = leadersRaw.map((leader, idx) => normalizeLeader(leader, idx));

          state.editingAdIndex = null;
          state.editingLeaderIndex = null;

          clearAdForm();
          clearLeaderForm();
          renderAds();
          renderLeaders();

          setJsonStatus("JSON ë‚´ìš©ì„ ê´€ë¦¬ì ë°ì´í„°ì— ì„±ê³µì ìœ¼ë¡œ ë®ì–´ì¼ìŠµë‹ˆë‹¤.", "success");
        } catch (err) {
          setJsonStatus("JSON íŒŒì‹± ì˜¤ë¥˜: " + err.message, "error");
        }
      });
    }

    function setJsonStatus(message, type) {
      const el = document.getElementById("json-status");
      el.textContent = message;
      el.className = "status " + (type || "info");
    }

    function fallbackCopy(text) {
      const temp = document.createElement("textarea");
      temp.value = text;
      document.body.appendChild(temp);
      temp.select();
      document.execCommand("copy");
      document.body.removeChild(temp);
    }

    // =============================
    // ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ / ë“œë˜ê·¸ ê³µí†µ í•¨ìˆ˜
    // =============================
    function initImagePickers() {
      initImageFilePicker({
        fileInputId: "ad-image-file",
        triggerId: "ad-image-file-trigger",
        dropId: "ad-image-drop",
        previewId: "ad-image-preview",
        targetInputId: "ad-image-url",
        folderPrefix: "images/"
      });

      initImageFilePicker({
        fileInputId: "leader-image-file",
        triggerId: "leader-image-file-trigger",
        dropId: "leader-image-drop",
        previewId: "leader-image-preview",
        targetInputId: "leader-image-url",
        folderPrefix: "images/"
      });
    }

    function initImageFilePicker({
      fileInputId,
      triggerId,
      dropId,
      previewId,
      targetInputId,
      folderPrefix
    }) {
      const fileInput = document.getElementById(fileInputId);
      const trigger = document.getElementById(triggerId);
      const drop = document.getElementById(dropId);
      const preview = document.getElementById(previewId);
      const targetInput = document.getElementById(targetInputId);
      if (!fileInput || !trigger || !drop || !targetInput) return;

      const handleFiles = files => {
        if (!files || !files.length) return;
        const file = files[0];
        const fileName = file.name;
        const url = (folderPrefix || "") + fileName;
        targetInput.value = url;
        if (preview) {
          const objectUrl = URL.createObjectURL(file);
          preview.src = objectUrl;
          preview.style.display = "block";
        }
      };

      trigger.addEventListener("click", () => fileInput.click());
      drop.addEventListener("click", () => fileInput.click());

      fileInput.addEventListener("change", e => handleFiles(e.target.files));

      drop.addEventListener("dragover", e => {
        e.preventDefault();
        drop.classList.add("dragover");
      });
      drop.addEventListener("dragleave", e => {
        e.preventDefault();
        drop.classList.remove("dragover");
      });
      drop.addEventListener("drop", e => {
        e.preventDefault();
        drop.classList.remove("dragover");
        const dt = e.dataTransfer;
        if (dt && dt.files) handleFiles(dt.files);
      });
    }

    // =============================
    // URL ì…ë ¥ â†’ ë¯¸ë¦¬ë³´ê¸° ê°±ì‹ 
    // =============================
    function initImageUrlPreview() {
      const adUrlInput = document.getElementById("ad-image-url");
      const leaderUrlInput = document.getElementById("leader-image-url");
      if (adUrlInput) {
        adUrlInput.addEventListener("input", updateAdPreviewFromUrl);
      }
      if (leaderUrlInput) {
        leaderUrlInput.addEventListener("input", updateLeaderPreviewFromUrl);
      }
    }

    function updateAdPreviewFromUrl() {
      const url = document.getElementById("ad-image-url").value.trim();
      const preview = document.getElementById("ad-image-preview");
      if (!preview) return;
      if (url) {
        preview.src = url;
        preview.style.display = "block";
      } else {
        preview.src = "";
        preview.style.display = "none";
      }
    }

    function updateLeaderPreviewFromUrl() {
      const url = document.getElementById("leader-image-url").value.trim();
      const preview = document.getElementById("leader-image-preview");
      if (!preview) return;
      if (url) {
        preview.src = url;
        preview.style.display = "block";
      } else {
        preview.src = "";
        preview.style.display = "none";
      }
    }

    // =============================
    // JSON ì •ê·œí™” (ì˜›ë‚  / ìƒˆ í•„ë“œ ì´ë¦„ ë§ì¶°ì£¼ê¸°)
    // =============================
    function normalizeAd(ad, index) {
      const out = { ...ad };

      if (!out.id) out.id = ad.id || generateId("ad");
      if (out.visible === undefined) out.visible = ad.visible !== false;

      if (!out.imageUrl) {
        out.imageUrl =
          ad.imageUrl ||
          ad.bannerImage ||
          ad.banner_image ||
          ad.bannerUrl ||
          ad.banner_url ||
          ad.image ||
          "";
      }

      return out;
    }

    function normalizeLeader(leader, index) {
  const out = { ...leader };

  // id ì—†ìœ¼ë©´ ìƒˆë¡œ ë¶€ì—¬
  if (!out.id) out.id = leader.id || generateId("leader");

  // visible ê°’ ì •ë¦¬
  if (out.visible === undefined) out.visible = leader.visible !== false;
  // ì˜›ë‚  JSONì—ì„œ enabled ë¼ëŠ” ì´ë¦„ì„ ì¼ë‹¤ë©´ ê·¸ê²ƒë„ ë°˜ì˜
  if (leader.enabled !== undefined && out.visible === undefined) {
    out.visible = !!leader.enabled;
  }

  // ì´ë¯¸ì§€ í•„ë“œ: ì˜¤ë˜ëœ JSONì€ mediaUrl ì„ ì“°ê³  ìˆì„ ìˆ˜ ìˆìŒ
  out.imageUrl =
    leader.imageUrl ||       // ìƒˆ ê´€ë¦¬ìì—ì„œ ì“°ëŠ” í•„ë“œ
    leader.mediaUrl  ||       // ì˜ˆì „ ê´€ë¦¬ìì—ì„œ ì“°ë˜ í•„ë“œ
    leader.profileImage ||
    leader.profile_image ||
    leader.profileImageUrl ||
    leader.profile_image_url ||
    leader.image ||
    "";

  // tags ê°€ ë¬¸ìì—´ì´ë©´ ì‰¼í‘œë¡œ ìª¼ê°œì„œ ë°°ì—´ë¡œ
  if (!Array.isArray(out.tags) && typeof leader.tags === "string") {
    out.tags = leader.tags
      .split(",")
      .map(t => t.trim())
      .filter(Boolean);
  }

  // sns ì—†ìœ¼ë©´ ê¸°ë³¸ê°’
  if (!out.sns) {
    out.sns = leader.sns || { youtube: "", tiktok: "", instagram: "", facebook: "", blog: "" };
  }

  // order ê°€ ì—†ìœ¼ë©´ "ë“¤ì–´ì˜¨ ìˆœì„œ"ë¡œ ë¶€ì—¬ â†’ JSON ìˆœì„œ ê·¸ëŒ€ë¡œ ìœ ì§€
  if (typeof out.order !== "number") {
    out.order = index + 1;
  }

  return out;
}


    // =============================
    // ìœ í‹¸
    // =============================
    function generateId(prefix) {
      const now = Date.now().toString(36);
      const rand = Math.random().toString(36).substring(2, 7);
      return prefix + "-" + now + "-" + rand;
    }
  </script>
</body>
</html>
